---
title: "NextAuth v5ã§Githubèªè¨¼ã‚„ã£ã¦ã¿ãŸ"
emoji: "ğŸ—ï¸"
type: "tech"
topics: [React, TypeScript, Javascript, Next]
published: true
---

## ã¯ã˜ã‚ã«

NextAuth v5 ã®è¨˜äº‹ãŒå°‘ãªã‹ã£ãŸã®ã§ã€ãƒ¡ãƒ¢ç¨‹åº¦ã§ã™ãŒæ›¸ã„ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚

## ç’°å¢ƒ

"next": "14.1.4",
"next-auth": "^5.0.0-beta.15",

â€» next-auth ã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®šãªã—ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ v4 ã«ãªã‚Šã¾ã™
2023 å¹´ 4 æœˆç¾åœ¨

## github OAuthApps è¨­å®š

OAuth èªè¨¼ã®è¨­å®šã‚’ã—ã¾ã™

profile > setting > Developer Settings > OAuth App

Homepage URL

```
http://localhost:3000
```

Authorization callback URL

```
http://localhost:3000/api/auth/callback/github
```

![](/images/github-app.png)
*AuthApp è¨­å®š*

## route ã‚’è¨­å®šã™ã‚‹

api/auth/[...next-auth]
ã“ã®ã‚ˆã†ã«ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã€route.ts ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

å¾Œã»ã©è¨­å®šã™ã‚‹ auth.ts ã‹ã‚‰ handlers ã‚’ import
GET,POST ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¾ã™ã€‚

```ts:api/auth/[...next-auth]/route.ts
import { handlers } from "@/auth/auth";

export const { GET, POST } = handlers;
```

## auth.ts è¨˜è¿°

Github ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’è¨­å®šã—ã€ãã‚Œãã‚Œ export ã—ã¾ã™

```ts:auth.ts
import NextAuth, { NextAuthConfig } from "next-auth";
import GithubProvider from "next-auth/providers/github";

const config: NextAuthConfig = {
  providers: [
    GithubProvider({
      clientId: process.env.GITHUB_CLIENT_ID,
      clientSecret: process.env.GITHUB_CLIENT_SECRET,
    }),
  ],
  basePath: "/api/auth",
};

export const { handlers, auth, signIn, signOut } = NextAuth(config);
```

## ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ã¦ã¿ã‚‹

ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã€ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆç”¨ã®ãƒœã‚¿ãƒ³ã‚’å®šç¾©ã—ã¾ã™

```tsx
import { signIn, signOut } from "@/auth/auth";

export async function SignInButton() {
  return (
    <button
      onClick={async () => {
        "use server";
        await signIn();
      }}
    >
      Sign in
    </button>
  );
}

export async function SignOutButton() {
  return (
    <button
      onClick={async () => {
        "use server";
        await signOut();
      }}
    >
      Sign out
    </button>
  );
}
```

## å‚è€ƒæ–‡çŒ®

https://authjs.dev/

https://authjs.dev/getting-started/authentication/oauth?provider=github
